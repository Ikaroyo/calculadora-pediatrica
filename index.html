<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Calculadora de Dosis Pediátrica</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f5f3ff; /* Light Purple background */
            background-image: url("data:image/svg+xml,%3Csvg width='20' height='20' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='%23ddd6fe' fill-opacity='0.6' fill-rule='evenodd'%3E%3Ccircle cx='3' cy='3' r='3'/%3E%3Ccircle cx='13' cy='13' r='3'/%3E%3C/g%3E%3C/svg%3E");
        }
        .calculator-card {
            background: #ffffff;
            box-shadow: 0 25px 50px -12px rgba(109, 40, 217, 0.2);
            border: 1px solid #e5e7eb;
        }
        .btn-primary {
            background-color: #8b5cf6; /* Vibrant Purple */
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px -5px rgba(139, 92, 246, 0.6);
        }
        .btn-primary:hover {
            background-color: #7c3aed;
            transform: translateY(-3px);
            box-shadow: 0 6px 20px -5px rgba(139, 92, 246, 0.8);
        }
        .result-box {
            background-color: #ede9fe; /* Light Purple */
            border-left: 4px solid #8b5cf6;
            opacity: 0;
            transform: translateY(10px) scale(0.98);
            transition: opacity 0.4s ease, transform 0.4s ease;
        }
        .result-box.show {
            opacity: 1;
            transform: translateY(0) scale(1);
        }
        .disclaimer {
            background-color: #fefce8; /* Light Yellow */
            border-left: 4px solid #facc15;
        }
        .form-input {
            border-width: 2px;
            border-color: #e5e7eb;
            transition: border-color 0.3s ease;
        }
        .form-input:focus {
            outline: none;
            border-color: #8b5cf6;
            box-shadow: 0 0 0 3px rgba(139, 92, 246, 0.2);
        }
        /* Estilos para la ventana emergente (Modal) */
        .modal-overlay {
            transition: opacity 0.3s ease;
        }
        .modal-content {
            transition: transform 0.3s ease, opacity 0.3s ease;
            transform: translateY(20px) scale(0.95);
            opacity: 0;
        }
        .modal-overlay.flex {
            opacity: 1;
        }
        .modal-overlay.flex .modal-content {
            transform: translateY(0) scale(1);
            opacity: 1;
        }
    </style>
</head>
<body class="flex flex-col items-center justify-center min-h-screen p-4">
    <div class="calculator-card w-full max-w-md mx-auto rounded-3xl p-6 md:p-8">
        
        <div class="text-center mb-8">
            <!-- Icono Infantil Mejorado -->
            <div class="mx-auto bg-purple-100 rounded-full h-20 w-20 flex items-center justify-center mb-4">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-12 w-12 text-purple-500" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
                    <path stroke-linecap="round" stroke-linejoin="round" d="M12 8v4l3 3" />
                    <path stroke-linecap="round" stroke-linejoin="round" d="M12 2v2" />
                    <path stroke-linecap="round" stroke-linejoin="round" d="M12 20v2" />
                    <path stroke-linecap="round" stroke-linejoin="round" d="M4 12H2" />
                    <path stroke-linecap="round" stroke-linejoin="round" d="M22 12h-2" />
                </svg>
            </div>
            <h1 class="text-2xl md:text-3xl font-bold text-gray-800">Calculadora Pediátrica</h1>
            <p class="text-gray-500 mt-1">Dosis por Kilo</p>
        </div>

        <!-- Input de Peso -->
        <div class="mb-4">
            <label for="weight" class="block text-sm font-medium text-gray-700 mb-2">Peso del niño (en kg)</label>
            <input type="number" id="weight" placeholder="Ej: 15" class="w-full px-4 py-3 text-gray-700 bg-white rounded-lg form-input">
        </div>

        <!-- Selección de Medicamento -->
        <div class="mb-6">
            <label for="medication" class="block text-sm font-medium text-gray-700 mb-2">Medicamento</label>
            <select id="medication" class="w-full px-4 py-3 text-gray-700 bg-white rounded-lg form-input">
                <option value="ibu_4">Ibuprofeno 4% (ej. Ibupirac, Actron)</option>
                <option value="ibu_2">Ibuprofeno 2% (ej. Ibupirac, Actron)</option>
                <option value="para">Paracetamol 100mg/ml (ej. Termofren, Tafirol)</option>
                <option value="dipi">Dipirona 50mg/ml (ej. Novalgina)</option>
            </select>
        </div>

        <!-- Botón de Calcular -->
        <button id="calculateBtn" class="w-full btn-primary text-white font-bold py-3 px-4 rounded-lg">
            Calcular Dosis
        </button>

        <!-- Área de Resultados -->
        <div id="result" class="mt-6 p-4 rounded-lg result-box">
            <h2 class="font-semibold text-gray-800">Dosis recomendada:</h2>
            <p id="resultText" class="text-3xl font-bold text-purple-700 mt-1"></p>
        </div>
        
        <!-- Mensaje de Error -->
        <div id="error" class="mt-4 text-red-600 text-sm hidden"></div>

        <!-- Disclaimer -->
        <div class="mt-8 p-3 rounded-lg disclaimer">
            <p class="text-xs text-yellow-800">
                <strong class="font-bold">Importante:</strong> Esta calculadora es una guía. Consulte siempre a un médico o farmacéutico.
            </p>
        </div>
    </div>

    <!-- Botón para abrir la ventana emergente -->
    <button id="openModalBtn" class="mt-6 flex items-center text-sm text-purple-600 hover:text-purple-800 font-semibold transition">
        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2" viewBox="0 0 20 20" fill="currentColor">
            <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd" />
        </svg>
        Información útil sobre medicamentos
    </button>

    <!-- Ventana Emergente (Modal) -->
    <div id="infoModal" class="modal-overlay fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center p-4">
        <div class="modal-content bg-white rounded-2xl shadow-xl p-6 md:p-8 max-w-2xl w-full max-h-[90vh] overflow-y-auto relative">
            <button id="closeModalBtn" class="absolute top-4 right-4 text-gray-400 hover:text-gray-700">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
                </svg>
            </button>
            <h2 class="text-2xl font-bold text-gray-800 mb-4">Información sobre Medicamentos</h2>
            <div class="text-gray-600 space-y-4">
                <p>Estos medicamentos son seguros a dosis recomendadas, pero tienen diferencias clave que nos ayudan a decidir cuál usar.</p>
                
                <div>
                    <h3 class="font-semibold text-lg text-purple-700">Ibuprofeno</h3>
                    <p>Es un antiinflamatorio no esteroideo (AINE). Su principal ventaja es que <strong class="font-semibold">reduce la inflamación</strong>. Es ideal para:</p>
                    <ul class="list-disc list-inside mt-2 space-y-1 pl-2">
                        <li>Dolor leve o moderado con inflamación (golpes, esguinces).</li>
                        <li>Dolores musculares o de articulaciones.</li>
                        <li>Dolor menstrual.</li>
                        <li>Fiebre alta que no cede fácilmente.</li>
                    </ul>
                </div>

                <div>
                    <h3 class="font-semibold text-lg text-teal-700">Paracetamol (Acetaminofeno)</h3>
                    <p>Es analgésico y antipirético, pero <strong class="font-semibold">no tiene un efecto antiinflamatorio</strong> significativo. Es la opción preferida para:</p>
                    <ul class="list-disc list-inside mt-2 space-y-1 pl-2">
                        <li>Fiebre con malestar general (como en la gripe).</li>
                        <li>Dolor leve o moderado sin inflamación (dolor de cabeza, muelas, espalda).</li>
                        <li>Cuando se busca bajar la fiebre como primer síntoma.</li>
                    </ul>
                </div>

                <div>
                    <h3 class="font-semibold text-lg text-red-700">Dipirona (Novalgina)</h3>
                    <p>Es un analgésico y antipirético <strong class="font-semibold">muy potente</strong>. Generalmente se reserva para:</p>
                    <ul class="list-disc list-inside mt-2 space-y-1 pl-2">
                        <li>Fiebre muy alta que no responde a ibuprofeno o paracetamol.</li>
                        <li>Dolor intenso postoperatorio o de otro tipo.</li>
                        <li>Su uso debe ser siempre bajo supervisión médica debido a posibles efectos adversos.</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>

    <script>
        // --- Elementos de la Calculadora ---
        const weightInput = document.getElementById('weight');
        const medicationSelect = document.getElementById('medication');
        const calculateBtn = document.getElementById('calculateBtn');
        const resultDiv = document.getElementById('result');
        const resultText = document.getElementById('resultText');
        const errorDiv = document.getElementById('error');

        // --- Elementos de la Ventana Emergente (Modal) ---
        const openModalBtn = document.getElementById('openModalBtn');
        const closeModalBtn = document.getElementById('closeModalBtn');
        const infoModal = document.getElementById('infoModal');

        // Ocultar el resultado al inicio
        resultDiv.style.display = 'none';

        // --- Lógica de Cálculo ---
        function calculateDose() {
            resultDiv.classList.remove('show');
            resultDiv.style.display = 'none';
            errorDiv.classList.add('hidden');

            const weight = parseFloat(weightInput.value);
            const medication = medicationSelect.value;
            
            if (isNaN(weight) || weight <= 0) {
                errorDiv.textContent = 'Por favor, ingrese un peso válido y mayor a cero.';
                errorDiv.classList.remove('hidden');
                return;
            }

            let dose = 0;

            switch (medication) {
                case 'ibu_4':
                    dose = weight / 4;
                    break;
                case 'ibu_2':
                    dose = weight / 2;
                    break;
                case 'para':
                    dose = (weight * 15) / 100;
                    break;
                case 'dipi':
                    dose = (weight * 15) / 50;
                    break;
            }

            resultText.textContent = `${dose.toFixed(2)} ml`;
            resultDiv.style.display = 'block';
            setTimeout(() => {
                resultDiv.classList.add('show');
            }, 10);
        }
        
        // --- Lógica de la Ventana Emergente ---
        function showModal() {
            infoModal.classList.remove('hidden');
            infoModal.classList.add('flex');
        }

        function hideModal() {
            infoModal.classList.add('hidden');
            infoModal.classList.remove('flex');
        }

        // --- Lógica para recordar la última selección ---
        function loadLastSelection() {
            const savedMedication = localStorage.getItem('lastMedication');
            if (savedMedication) {
                medicationSelect.value = savedMedication;
            }
        }

        function saveLastSelection() {
            localStorage.setItem('lastMedication', medicationSelect.value);
        }

        // --- Event Listeners ---
        calculateBtn.addEventListener('click', calculateDose);
        weightInput.addEventListener('keypress', function(event) {
            if (event.key === 'Enter') {
                calculateDose();
            }
        });

        // Guardar la selección del medicamento al cambiar
        medicationSelect.addEventListener('change', saveLastSelection);

        openModalBtn.addEventListener('click', showModal);
        closeModalBtn.addEventListener('click', hideModal);
        // Cerrar modal al hacer clic fuera del contenido
        infoModal.addEventListener('click', function(event) {
            if (event.target === infoModal) {
                hideModal();
            }
        });

        // Cargar la última selección al iniciar la página
        loadLastSelection();
    </script>
</body>
</html>